{"repository_name":"github.com/Monpt7/crexcel","body":"# crexcel\n\n[![Build Status](https://travis-ci.org/Monpt7/crexcel.svg?branch=master)](https://travis-ci.org/Monpt7/crexcel)\n\ncrexcel is a crystal library to generate XLSX files almost like this [python module](https://github.com/jmcnamara/XlsxWriter)\n\n**Important note :** this library only works with the master branch of Crystal for the moment. 0.24.2 version doesn't work but I hope 0.24.3 will!\n\n## Installation\n\nAdd this to your application's `shard.yml`:\n\n```yaml\ndependencies:\n  crexcel:\n    github: Monpt7/crexcel\n```\n\n## Usage\n\n```crystal\nrequire \"crexcel\"\n```\n\nDocs are comming but it needs features before...\n\n## Contributing\n\n1. Fork it ( https://github.com/Monpt7/crexcel/fork )\n2. Create your feature branch (git checkout -b my-new-feature)\n3. Commit your changes (git commit -am 'Add some feature')\n4. Push to the branch (git push origin my-new-feature)\n5. Create a new Pull Request\n\n## Contributors\n\n- [Monpt7](https://github.com/Monpt7) - creator, maintainer\n","program":{"html_id":"github.com/Monpt7/crexcel/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"github.com/Monpt7/crexcel","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/Monpt7/crexcel/Crexcel","path":"Crexcel.html","kind":"module","full_name":"Crexcel","name":"Crexcel","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"crexcel/archive_builder.cr","line_number":1,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/archive_builder.cr"},{"filename":"crexcel/shared_string.cr","line_number":1,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/shared_string.cr"},{"filename":"crexcel/version.cr","line_number":1,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/version.cr"},{"filename":"crexcel/workbook.cr","line_number":3,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr"},{"filename":"crexcel/worksheet.cr","line_number":2,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr"},{"filename":"crexcel.cr","line_number":4,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel.cr"}],"repository_name":"github.com/Monpt7/crexcel","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"name":"VERSION","value":"\"0.1.0\"","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":"TODO: Write documentation for `Crexcel`","summary":"<p><span class=\"flag orange\">TODO</span>  Write documentation for <code><a href=\"Crexcel.html\">Crexcel</a></code></p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"github.com/Monpt7/crexcel/Crexcel/Workbook","path":"Crexcel/Workbook.html","kind":"class","full_name":"Crexcel::Workbook","name":"Workbook","abstract":false,"superclass":{"html_id":"github.com/Monpt7/crexcel/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/Monpt7/crexcel/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/Monpt7/crexcel/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"crexcel/workbook.cr","line_number":7,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr"}],"repository_name":"github.com/Monpt7/crexcel","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/Monpt7/crexcel/Crexcel","kind":"module","full_name":"Crexcel","name":"Crexcel"},"doc":"The Workbook Class is the main class of Crexcel.\nIt create the file which will contains the worksheets.\nNOTE: Don't forget to call the close method in order to generate your xlsx file!","summary":"<p>The Workbook Class is the main class of Crexcel.</p>","class_methods":[],"constructors":[{"id":"new(name:String)-class-method","html_id":"new(name:String)-class-method","name":"new","doc":"The new method let you create a workbook, you only need one per file you want to generate.\n\nYou must give a name to it :\n\n```\nmy_workbook = Workbook.new(\"thing.xlsx\")\n```\nNOTE: You are not forced to give the extension, if you type `Workbook.new(\"thing\")`\n it will still create a 'thing.xlsx' file.","summary":"<p>The new method let you create a workbook, you only need one per file you want to generate.</p>","abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"args_string":"(name : String)","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L23","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L23","def":{"name":"new","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(name)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"add_worksheet(name:String)-instance-method","html_id":"add_worksheet(name:String)-instance-method","name":"add_worksheet","doc":null,"summary":null,"abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"args_string":"(name : String)","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L49","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L49","def":{"name":"add_worksheet","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"worksheet = Worksheet.new(name)\n@sheets << worksheet\nworksheet\n"}},{"id":"add_worksheet-instance-method","html_id":"add_worksheet-instance-method","name":"add_worksheet","doc":"Call this to add a worksheet to the workbook without giving it a name.\n\nIt returns a Worksheet object\n```\nworkbook = Workbook.new(\"thing.xlsx\")\nfirst_worksheet = workbook.add_worksheet\n```","summary":"<p>Call this to add a worksheet to the workbook without giving it a name.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L41","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L41","def":{"name":"add_worksheet","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"nbr_sheet = @sheets.size + 1\nname = \"Sheet\" + nbr_sheet.to_s\nworksheet = Worksheet.new(name)\n@sheets << worksheet\nworksheet\n"}},{"id":"close-instance-method","html_id":"close-instance-method","name":"close","doc":"This function close the workbook and generate a xlsx file.\nYou **MUST** call this function at the end of you script for each Workbook created.\nIf you don't, this will not generate the xlsx file.\nOPTIMIZE: In the future, not closing a Workbook will raise an error\n instead of silently not generate the file.","summary":"<p>This function close the workbook and generate a xlsx file.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L60","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L60","def":{"name":"close","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"Dir.mkdir(@directory)\nDir.mkdir(@directory + \"_rels\")\nDir.mkdir(@directory + \"docProps\")\nDir.mkdir(@xldir)\nDir.mkdir(@xldir + \"_rels\")\nDir.mkdir(@xldir + \"theme\")\nDir.mkdir(@xldir + \"worksheets\")\nArchiveBuilder.new(@directory, @sheets.size)\nSharedString.generate_xml(@xldir + \"sharedStrings.xml\")\nwrite_worksheets_xml\nwrite_workbook_xml\nwrite_rels_xml\ngenerate_xlsx\n"}},{"id":"name:String-instance-method","html_id":"name:String-instance-method","name":"name","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L12","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/workbook.cr#L12","def":{"name":"name","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@name"}}],"macros":[],"types":[]},{"html_id":"github.com/Monpt7/crexcel/Crexcel/Worksheet","path":"Crexcel/Worksheet.html","kind":"class","full_name":"Crexcel::Worksheet","name":"Worksheet","abstract":false,"superclass":{"html_id":"github.com/Monpt7/crexcel/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"github.com/Monpt7/crexcel/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"github.com/Monpt7/crexcel/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"crexcel/worksheet.cr","line_number":4,"url":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr"}],"repository_name":"github.com/Monpt7/crexcel","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"github.com/Monpt7/crexcel/Crexcel","kind":"module","full_name":"Crexcel","name":"Crexcel"},"doc":"TODO Write doc for Worksheet class","summary":"<p><span class=\"flag orange\">TODO</span>  Write doc for Worksheet class</p>","class_methods":[],"constructors":[{"id":"new(name:String)-class-method","html_id":"new(name:String)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"args_string":"(name : String)","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L8","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L8","def":{"name":"new","args":[{"name":"name","doc":null,"default_value":"","external_name":"name","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(name)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"get_datas:Array({pos:String,value:String,type:String})-instance-method","html_id":"get_datas:Array({pos:String,value:String,type:String})-instance-method","name":"get_datas","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Array({pos: String, value: String, type: String})","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L28","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L28","def":{"name":"get_datas","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@datas"}},{"id":"get_tidy_datas-instance-method","html_id":"get_tidy_datas-instance-method","name":"get_tidy_datas","doc":null,"summary":null,"abstract":false,"args":[],"args_string":"","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L32","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L32","def":{"name":"get_tidy_datas","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"tidy_datas = Hash(Int32, Array(NamedTuple(pos: String, value: String, type: String))).new\nsorted_datas = @datas.sort do |a, b|\n  tmpa = (/[A-Z]*([\\d]*)/).match(a[\"pos\"])\n  tmpb = (/[A-Z]*([\\d]*)/).match(b[\"pos\"])\n  if tmpa.not_nil![1].to_i > tmpb.not_nil![1].to_i\n    1\n  else\n    if tmpa.not_nil![1].to_i == tmpb.not_nil![1].to_i\n      if tmpa.not_nil![0] > tmpb.not_nil![0]\n        1\n      else\n        -1\n      end\n    else\n      -1\n    end\n  end\nend\nsorted_datas.each do |data|\n  row = (/[A-Z]*([\\d]*)/).match(data[\"pos\"])\n  row = row.not_nil![1].to_i\n  if tidy_datas.has_key?(row)\n  else\n    tidy_datas[row] = Array(NamedTuple(pos: String, value: String, type: String)).new\n  end\n  tidy_datas[row] << data\nend\ntidy_datas\n"}},{"id":"name:String-instance-method","html_id":"name:String-instance-method","name":"name","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L6","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L6","def":{"name":"name","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@name"}},{"id":"write(pos_x:Int32|Int64,pos_y:Int32|Int64,str:Int32|Int64|Float64|String)-instance-method","html_id":"write(pos_x:Int32|Int64,pos_y:Int32|Int64,str:Int32|Int64|Float64|String)-instance-method","name":"write","doc":null,"summary":null,"abstract":false,"args":[{"name":"pos_x","doc":null,"default_value":"","external_name":"pos_x","restriction":"Int32 | Int64"},{"name":"pos_y","doc":null,"default_value":"","external_name":"pos_y","restriction":"Int32 | Int64"},{"name":"str","doc":null,"default_value":"","external_name":"str","restriction":"Int32 | Int64 | Float64 | String"}],"args_string":"(pos_x : Int32 | Int64, pos_y : Int32 | Int64, str : Int32 | Int64 | Float64 | String)","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L24","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L24","def":{"name":"write","args":[{"name":"pos_x","doc":null,"default_value":"","external_name":"pos_x","restriction":"Int32 | Int64"},{"name":"pos_y","doc":null,"default_value":"","external_name":"pos_y","restriction":"Int32 | Int64"},{"name":"str","doc":null,"default_value":"","external_name":"str","restriction":"Int32 | Int64 | Float64 | String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"write(int_pos_to_char(pos_x, pos_y), str)"}},{"id":"write(position:String,str:Int32|Int64|Float64|String)-instance-method","html_id":"write(position:String,str:Int32|Int64|Float64|String)-instance-method","name":"write","doc":null,"summary":null,"abstract":false,"args":[{"name":"position","doc":null,"default_value":"","external_name":"position","restriction":"String"},{"name":"str","doc":null,"default_value":"","external_name":"str","restriction":"Int32 | Int64 | Float64 | String"}],"args_string":"(position : String, str : Int32 | Int64 | Float64 | String)","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L13","source_link":"https://github.com/Monpt7/crexcel/blob/4fb5d5be164f91177b974d59b8a9e2702e590fbd/src/crexcel/worksheet.cr#L13","def":{"name":"write","args":[{"name":"position","doc":null,"default_value":"","external_name":"position","restriction":"String"},{"name":"str","doc":null,"default_value":"","external_name":"str","restriction":"Int32 | Int64 | Float64 | String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"if str.is_a?(String)\n  value = (Crexcel::SharedString.new(str)).index.to_s\n  type = \"s\"\nelse\n  value = str.to_s\n  type = \"\"\nend\n@datas << ({pos: position, value: value, type: type})\n"}}],"macros":[],"types":[]}]}]}}